#include "upgrade.h"
#include "shared.h"
#include "pilot.h"
#include <list>

static SModifier SNone = [](const Pilot&) { return 0;};
static AModifier ANone = [](const Pilot&) { return Act::None;};
static UModifier UNone = [](const Pilot&) { return std::vector<Upg>();};

#define S(x)  [](Pilot p) { return x;}

#define cTIX1 [](Pilot p) {for(Upgrade u : p.GetAppliedUpgrades()){ if(u.GetType()==Upg::System){ if(u.GetCost()<=4){return 0-u.GetCost();}else{return -4;} }} return 0;}
#define hSCYK [](Pilot p) { return 1;}

#define aBOSL [](Pilot p) { return Act::SLAM;}
#define aENUP [](Pilot p) { return Act::Boost;}
#define aMFAL [](Pilot p) { return Act::Evade;}
#define aMHUN [](Pilot p) { return Act::BarrelRoll;}
#define aTCOM [](Pilot p) { return Act::TargetLock;}
#define aVECT [](Pilot p) { return Act::BarrelRoll;}

#define uANDR [](Pilot p) { return std::vector<Upg>{Upg::Bomb, Upg::Bomb};}
#define uAWTP [](Pilot p) { return std::vector<Upg>{Upg::Elite};}
#define uBWE2 [](Pilot p) { return std::vector<Upg>{Upg::Crew};}
#define uR2D6 [](Pilot p) { return std::vector<Upg>{Upg::Elite};}
#define uRGTI [](Pilot p) { return std::vector<Upg>{Upg::Modification};}
#define uSABW [](Pilot p) { return std::vector<Upg>{Upg::Bomb};}
#define uaTIS [](Pilot p) { return std::vector<Upg>{Upg::Torpedo, Upg::Torpedo, Upg::Missile, Upg::Missile, Upg::Bomb};}
#define urTIS [](Pilot p) { return std::vector<Upg>{Upg::Crew, Upg::Crew};}
#define uSCOM [](Pilot p) { return std::vector<Upg>{Upg::Illicit, Upg::Modification};}
#define uHSCY [](Pilot p) { return std::vector<Upg>{Upg::Cannon,Upg::Torpedo,Upg::Missile};}
#define uTIX1 [](Pilot p) { return std::vector<Upg>{Upg::System};}
#define uTIX7 [](Pilot p) { return std::vector<Upg>{Upg::Cannon,Upg::Missile};}
#define uVIRA [](Pilot p) { return std::vector<Upg>{Upg::System,Upg::Illicit};}
#define uSAMP [](Pilot p) { return std::vector<Upg>{Upg::Crew,Upg::Illicit};}

static RestrictionCheck RNone = [](Pilot p) { return std::vector<std::string>();};

static RestrictionCheck RC(Faction f, BaseSize b, RestrictionCheck other) {
  return [f, b, other](Pilot p) {
    std::vector<std::string> ret;
    if((f & p.GetFaction()) != p.GetFaction()) {
      ret.push_back("Faction: Requires " + FactionToString(f) + " but played on " + FactionToString(p.GetFaction()));
    }
    if((b & p.GetBaseSize()) != p.GetBaseSize()) {
      ret.push_back("Base: Requires " + BaseSizeToString(b) + " but played on " + BaseSizeToString(b));
    }
    for(std::string s : other(p)) {
      ret.push_back(s);
    }
    return ret;
  };
}

static RestrictionCheck Ship(std::string sh) {
  return [sh](Pilot p) {
    std::vector<std::string> ret;
    if(p.GetShipNameXws() != sh) {
      ret.push_back("Ship: Requires " + sh + " but played on " + p.GetShipNameXws());
    }
    return ret;
  };
}

static RestrictionCheck TIE() {
  return [](Pilot p) {
    std::vector<std::string> ret;
    if(p.GetShipNameXws().find("tie") == std::string::npos) {
      ret.push_back("Ship: Requires TIE but played on " + p.GetShipNameXws());
    }
    return ret;
  };
}

static RestrictionCheck XW() {
  return [](Pilot p) {
    std::vector<std::string> ret;
    if(p.GetShipNameXws().find("xwing") == std::string::npos) {
      ret.push_back("Ship: Requires X-Wing but played on " + p.GetShipNameXws());
    }
    return ret;
  };
}

static RestrictionCheck YT() {
  return [](Pilot p) {
    std::vector<std::string> ret;
    if((p.GetShipNameXws() != "yt1300") && (p.GetShipNameXws() != "yt2400")) {
      ret.push_back("Ship: Requires YT-1300 or YT-2400 but played on " + p.GetShipNameXws());
    }
    return ret;
  };
}
static RestrictionCheck AT() {
  return [](Pilot p) {
    std::vector<std::string> ret;
    if((p.GetModActions() & Act::Boost) != Act::Boost) {
      ret.push_back("Action: Autothrusters requires Boost");
    }
    return ret;
  };
}

static RestrictionCheck HSCY() {
  return [](Pilot p) {
    std::vector<std::string> ret;
    if(p.GetShipNameXws() != "m3ainterceptor") {
      ret.push_back("Ship: Requires M3-A but played on " + p.GetShipNameXws());
    }
    int c = 0;
    for(Upgrade u : p.GetAppliedUpgrades()) {
      if(u.GetType() == Upg::Cannon)  { c++; }
      if(u.GetType() == Upg::Torpedo) { c++; }
      if(u.GetType() == Upg::Missile) { c++; }
    }
    if(c > 1) {
      ret.push_back("Upgrade: Allows Cannon, Torpedo, or Missile but multiple were added");
    }
    return ret;
  };
}



std::list<Upgrade> Upgrade::upgrades = {
  // Name                            ShortName           XwsName                      Type                    Slots                    Co  uni    lim      sk     at     ag     hu     sh     co     +act   -act   +upg   -upg
  { "Determination",                "Determination",    "determination",              Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you are dealt a faceup Damage card with the Pilot trait, discard it immediately without resolving its effect." },
  { "Marksmanship",                 "Marksmanship",     "marksmanship",               Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: When attacking this round, you may change 1 of your {FOCUS} results to a {CRIT} result and all your other {FOCUS} results to {HIT} results." },
  { "Expert Handling",              "Expert Hand",      "experthandling",             Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Perform a free barrel roll action.  If you do not have the {BARRELROLL} action icon, receive 1 stress token.  You may then remove 1 enemy target lock from your ship." },
  { "Swarm Tactics",                "Swarm Tact",       "swarmtactics",               Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the start of the Combat phase, you may choose 1 friendly ship at Range 1.  Until the end of this phase, treat the chosen ship as if its pilot skill were equal to your pilot skill." },
  { "Squad Leader",                 "Squad Leader",     "squadleader",                Upg::Elite,             {Upg::Elite},             2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Choose 1 ship at Range 1-2 that has a lower pilot skill than you.  The chosen ship may immediately perform 1 free action." },
  { "Draw Their Fire",              "Draw Their Fire",  "drawtheirfire",              Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When a friendly ship at Range 1 is hit by an attack, you may suffer 1 of the uncanceled {CRIT} results instead of the target ship." },
  { "Elusiveness",                  "Elusiveness",      "elusiveness",                Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When defending, you may receive 1 stress token to choose 1 attack die.  The attacker must reroll that die.  If you have at least 1 stress token, you cannot use this ability." },
  { "Veteran Instincts",            "VI",               "veteraninstincts",           Upg::Elite,             {Upg::Elite},             1, false, false, {  S(2), SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Increase your pilot skill value by 2." },
  { "Expose",                       "Expose",           "expose",                     Upg::Elite,             {Upg::Elite},             4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Until the end of this round, increase your primary weapon value by 1 and decrease your agility value by 1." },
  { "Deadeye",                      "Deadeye",          "deadeye",                    Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "You may treat the \"Attack (Target Lock):\" header as \"Attack (Focus):.\"  When an attack instructs you to spend a target lock, you may spend a focus token instead." },
  { "Push the Limit",               "PTL",              "pushthelimit",               Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Once per round, after you perform an action, you may perform 1 free action shown in your action bar.  Then receive 1 stress token." },
  { "Daredevil",                    "Daredevil",        "daredevil",                  Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Execute a white [LTURN 1] or [RTURN 1] maneuver.  Then, receive 1 stress token.  Then, if you do not have the {BOOST} action icon, roll 2 attack dice.  Suffer any damage ({HIT}) and critical damage ({CRIT}) rolled." },
  { "Adrenaline Rush",              "Adrenaline Rsh",   "adrenalinerush",             Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal a red maneuver, you may discard this card to treat that maneuver as a white maneuver until the end of the Activation phase." },
  { "Opportunist",                  "Opporunist",       "opportunist",                Upg::Elite,             {Upg::Elite},             4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, if the defender does not have any focus or evade tokens, you may receive 1 stress token to roll 1 additional attack die.  You cannot use this ability if you have any stress tokens." },
  { "Decoy",                        "Decoy",            "decoy",                      Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the start of the Combat phase, you may choose 1 friendly ship at Range 1-2.  Exchange your pilot skill with that ship's pilot skill until the end of the phase." },
  { "Wingman",                      "Wingman",          "wingman",                    Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the start of the Combat phase, remove 1 stress token from another friendly ship at Range 1." },
  { "Outmaneuver",                  "Outmaneuver",      "outmaneuver",                Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking a ship inside your firing arc, if you are not inside that ship's firing arc, reduce its agility value by 1 (to a minimum of 0)." },
  { "Predator",                     "Predator",         "predator",                   Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, you may reroll 1 attack die.  If the defender's pilot skill value is \"2\" or lower, you may instead reroll up to 2 attack dice." },
  { "Lone Wolf",                    "Lone Wolf",        "lonewolf",                   Upg::Elite,             {Upg::Elite},             2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking or defending, if there are no other friendly ships at Range 1-2, you may reroll 1 of your blank results." },
  { "Stay on Target",               "Stay on Trgt",     "stayontarget",               Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal a maneuver, you may rotate your dial to another maneuver with the same speed.  Treat your maneuver as a red maneuver." },
  { "Intimidation",                 "Intimidation",     "intimidation",               Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "While you are touching an enemy ship, reduce that ship's agility value by 1." },
  { "Ruthlessness",                 "Ruthlessness",     "ruthlessness",               Upg::Elite,             {Upg::Elite},             3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "After you perform an attack that hits, you must choose 1 other ship at Range 1 of the defender (other than yourself).  That ship suffers 1 damage." },
  { "Bodyguard",                    "Bodyguard",        "bodyguard",                  Upg::Elite,             {Upg::Elite},             2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "At the start of the Combat phase, you may spend a focus token to choose a friendly ship at Range 1 with higher pilot skill than you.  Increase its agility value by 1 until the end of the round." },
  { "Calculation",                  "Calculation",      "calculation",                Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, you may spend a focus token to change 1 of your {FOCUS} results to a {CRIT} result." },
  { "Crack Shot",                   "Crack Shot",       "crackshot",                  Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking a ship inside your firing arc, at the start of the 'Compare Results' step, you may discard this card to cancel 1 of the defender's {EVADE} results." },
  { "Lightning Reflexes",           "Lightning Rf",     "lightningreflexes",          Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "After you execute a white or green maneuver on your dial, you may discard this card to rotate your ship 180˚.  Then receive 1 stress token after the \"Check Pilot Stress\" step." },
  { "Wired",                        "Wired",            "wired",                      Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking or defending, if you are stressed, you may reroll 1 or more of your {FOCUS} results." },
  { "Cool Hand",                    "Cool Hand",        "coolhand",                   Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you receive a stress token, you may discard this card to assign 1 focus or evade token to your ship." },
  { "Juke",                         "Juke",             "juke",                       Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "When attacking, if you have an evade token, you may change 1 of the defender's {EVADE} results to a {FOCUS} result." },
  { "Adaptability",                 "Adaptability",     "adaptability",               Upg::Elite,             {Upg::Elite},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Increase your pilot skill value by 1 - Decrease your pilot skill value by 1." },
  { "Rage",                         "Rage",             "rage",                       Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Assign 1 focus token to your ship and receive 2 stress tokens.  Until the end of the round, when attacking, you may reroll up to 3 attack dice." },
  { "Attanni Mindlink",             "Attani Mindlink",  "attannimindlink",            Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "Each time you are assigned a focus or stress token, each other friendly ship with Attanni Mindlink must also be assigned the same type of token if it does not already have one." },
  { "Fearlessness",                 "Fearlessness",     "fearlessness",               Upg::Elite,             {Upg::Elite},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "When attacking, if you are inside the defender's firing arc at Range 1 and the defender is inside your firing arc, you may add 1 {HIT} result to your roll." },
  { "Snap Shot",                    "Snap Shot",        "snapshot",                   Upg::Elite,             {Upg::Elite},             2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After an enemy ship executes a maneuver, you may perform this attack against that ship.  2  1  Attack: Attack 1 ship.  You cannot modify your attack dice and cannot attack again this phase." },
  { "Trick Shot",                   "Trick Shot",       "trickshot",                  Upg::Elite,             {Upg::Elite},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, if the attack is obstructed, you may roll 1 additional attack die." },
  { "Expertise",                    "Expertise",        "expertise",                  Upg::Elite,             {Upg::Elite},             4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, if you are not stressed, you may change all of your {FOCUS} results to {HIT} results." },
  { "Swarm Leader",                 "Swarm Leader",     "swarmleader",                Upg::Elite,             {Upg::Elite},             3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When performing a primary weapon attack, choose up to 2 other friendly ships that have the defender inside their firing arcs at Range 1-3.  Remove 1 evade token from each chosen ship to roll 1 additional attack die for each token removes." },
  { "A Score to Settle",            "Score to Settle",  "ascoretosettle",             Upg::Elite,             {Upg::Elite},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "During setup, before the \"Place Forces\" step, choose 1 enemy ship and assign the \"A Debt to Pay\" condition card to it.  When attacking a ship that has the \"A Debt to Pay\" Condition card, you may change 1 {FOCUS} result to a {CRIT} result." },

  { "R2-D2",                        "R2-D2",            "r2d2",                       Upg::Astromech,         {Upg::Astromech},         4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After executing a green maneuver, you may recover 1 shield (up to your shield value)." },
  { "R2-F2",                        "R2-F2",            "r2f2",                       Upg::Astromech,         {Upg::Astromech},         4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: increase your agility value by 1 until the end of theis game round." },
  { "R5 Astromech",                 "R5",               "r5astromech",                Upg::Astromech,         {Upg::Astromech},         1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "During the end phase, you may choose 1 of your faceup Damage cards with the Ship trait and flip it facedown." },
  { "R5-K6",                        "R5-K6",            "r5k6",                       Upg::Astromech,         {Upg::Astromech},         1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After spending your target lock, roll 1 defense die.  On a {EVADE} result, immediately acquire a target lock on that same ship.  You cannot spend this target lock during this attack." },
  { "R2 Astromech",                 "R2",               "r2astromech",                Upg::Astromech,         {Upg::Astromech},         1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "You may treat all 1- and 2-speed maneuvers as green maneuvers." },
  { "R5-D8",                        "R5-D8",            "r5d8",                       Upg::Astromech,         {Upg::Astromech},         3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Roll 1 defense die.  On a {EVADE} or {FOCUS} result, discard 1 of your facedown Damage cards." },
  { "R2-D6",                        "R2-D6",            "r2d6",                       Upg::Astromech,         {Upg::Astromech},         1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uR2D6, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Your upgrade bar gains the {ELITE} upgrade icon.  You cannot equip this upgrade if you already have a {ELITE} upgrade icon or if your pilot skill value is \"2\" or lower." },
  { "R3-A2",                        "R3-A2",            "r3a2",                       Upg::Astromech,         {Upg::Astromech},         2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you declare the target of your attack, if the defender is inside your firing arc, you may receive 1 stress token to cause the defender to receive 1 stress token." },
  { "R4-D6",                        "R4-D6",            "r4d6",                       Upg::Astromech,         {Upg::Astromech},         1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you are hit by an attack and there are at least 3 uncanceled {HIT} results, you may chose and cancel those results until there are 2 remaining.  For each result canceled in this way, receive 1 stress token." },
  { "R5-P9",                        "R5-P9",            "r5p9",                       Upg::Astromech,         {Upg::Astromech},         3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the end of the Combat phase, you may spend 1 of your focus tokens to recover 1 shield (up to your shield value)." },
  { "R7 Astromech",                 "R7",               "r7astromech",                Upg::Astromech,         {Upg::Astromech},         2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Once per round when defending, if you have a target lock on the attacker, you may sped the target lock to choose any or all attack dice.  The attacker must reroll the chosen dice." },
  { "R7-T1",                        "R7-T1",            "r7t1",                       Upg::Astromech,         {Upg::Astromech},         3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Choose an enemy ship at Range 1-2.  If you are inside that ship's firing arc, you may acquire a target lock on that ship.  Then, you may perform a free boost action." },
  { "BB-8",                         "BB-8",             "bb8",                        Upg::Astromech,         {Upg::Astromech},         2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal a green maneuver, you may perform a free barrel roll action." },
  { "R5-X3",                        "R5-X3",            "r5x3",                       Upg::Astromech,         {Upg::Astromech},         1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Before you reveal your maneuver, you may discard this card to ignore obstacles until the end of the round." },
  { "Targeting Astromech",          "Targeting Ast",    "targetingastromech",         Upg::Astromech,         {Upg::Astromech},         2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After you execute a red maneuver, you may acquire a target lock." },
  { "R3 Astromech",                 "R3",               "r3astromech",                Upg::Astromech,         {Upg::Astromech},         2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Once per round, when attacking with a primary weapon, you may cancel 1 of your {FOCUS} results during the \"Modify Attack Dice\" step to assign 1 evade token to your ship." },
  { "M9-G8",                        "M9-G8",            "m9g8",                       Upg::Astromech,         {Upg::Astromech},         3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When a ship you have locked is attacking, you may choose 1 attack die.  The attacker must reroll that die.  You can acquire target locks on other friendly ships." },

  { "Proton Torpedoes",             "Proton Torp",      "protontorpedoes",            Upg::Torpedo,           {Upg::Torpedo},           4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  You may change 1 of your {FOCUS} results to a {CRIT} result." },
  { "Adv. Proton Torpedoes",        "Adv. Proton",      "advprotontorpedoes",         Upg::Torpedo,           {Upg::Torpedo},           6, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "5  1    Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  You may change up to 3 of your blank results to {FOCUS} results." },
  { "Flechette Torpedoes",          "Flechette",        "flechettetorpedoes",         Upg::Torpedo,           {Upg::Torpedo},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "3  2-3  Attack (Target Lock): Discard this card and spend your target lock to perform this attack.  After you perform this attack, the defender receives 1 stress token if its hull value is \"4\" or lower." },
  { "Ion Torpedoes",                "Ion",              "iontorpedoes",               Upg::Torpedo,           {Upg::Torpedo},           5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  If this attack hits, the defender and each ship at Range 1 of it receive 1 ion token." },
  { "Bomb Loadout",                 "Bomb Loadout",     "bombloadout",                Upg::Torpedo,           {Upg::Torpedo},           0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("ywing")), "Your upgrade bar gains the {BOMB} upgrade icon." },
  { "Extra Munitions",              "Extra Mun",        "extramunitions",             Upg::Torpedo,           {Upg::Torpedo},           2, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "When you equip this card, place 1 ordnance token on each equipped {TORPEDO}, {MISILE}, and {BOMB} Upgrade card.  When you are instructed to discard an Upgrade card, you may discard 1 ordnance token on that card instead." },
  { "Plasma Torpedoes",             "Plasma",           "plasmatorpedoes",            Upg::Torpedo,           {Upg::Torpedo},           3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  If this attack hits, after dealing damage, remove 1 shield token from the defender." },
  { "Seismic Torpedo",              "Seismic",          "seismictorpedo",             Upg::Torpedo,           {Upg::Torpedo},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "Action: Discard this card to choose an obstacle at Range 1-2 and inside your primary firing arc.  Each ship at Range 1 of the obstacle rolls 1 attack die and suffers any damage ({HIT}) or critical damage ({CRIT}) rolled.  Then remove the obstacle." },

  { "Ion Cannon Turret",            "Ion Can Tur",      "ioncannonturret",            Upg::Turret,            {Upg::Turret},            5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-2  Attack: Attack 1 ship (even a ship outside your firing arc).  If this attack hits the target ship, the ship suffers 1 damage and receives 1 ion token.  Then cancel all dice results." },
  { "Blaster Turret",               "Blaster Turret",   "blasterturret",              Upg::Turret,            {Upg::Turret},            4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-2  Attack (Focus): Spend 1 focus token to perform this attack against 1 ship (even a ship outside your firing arc)." },
  { "Autoblaster Turret",           "Autoblaster",      "autoblasterturret",          Upg::Turret,            {Upg::Turret},            2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "2  1    Attack: Attack 1 ship (even a ship outside your firing arc).  Your {HIT} results cannot be canceled by defense dice.  The defender may cancel {CRIT} results before {HIT} results." },
  { "Twin Laser Turret",            "TLT",              "twinlaserturret",            Upg::Turret,            {Upg::Turret},            6, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  2-3  Attack: Perform this attack twice (even against a ship outside your firing arc}.  Each time this attack hits, the defender suffers 1 damage.  Then cancel all dice results." },
  { "Dorsal Turret",                "Dorsal Turret",    "dorsalturret",               Upg::Turret,            {Upg::Turret},            3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "" },

  { "Cluster Missiles",             "Cluster Msls",     "clustermissiles",            Upg::Missile,           {Upg::Missile},           4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "3  1-2  Attack (Target Lock): Spend your target lock and discard this card to perform this attack twice." },
  { "Concussion Missiles",          "Concussion Msls",  "concussionmissiles",         Upg::Missile,           {Upg::Missile},           4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  You may change 1 of your blank results to a {HIT} result." },
  { "Assault Missiles",             "Assault Msls",     "assaultmissiles",            Upg::Missile,           {Upg::Missile},           5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Spend your target lock and discard this card to perform this attack.  If this attack hits, each other ship at Range 1 of the defender suffers 1 damage." },
  { "Homing Missiles",              "Homing",           "homingmissiles",             Upg::Missile,           {Upg::Missile},           5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "4  2-3  Attack (Target Lock): Discard this card to perform this attack.  The defender cannot spend evade tokens during this attack." },
  { "Ion Pulse Missile",            "Ion Pulse",        "ionpulsemissile",            Upg::Missile,           {Upg::Missile},           3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "3  2-3  Attack (Target Lock): Discard this card to perform this attack.  If this attack hits, the defender suffers 1 damage and receives 2 ion tokens.  Then cancel all dice results." },
  { "Chardaan Refit",               "Chardaan Rft",     "chardaanrefit",              Upg::Missile,           {Upg::Missile},          -2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("awing")), "This card has a negative squad point cost." },
  { "Proton Rockets",               "Proton Rockets",   "protonrockets",              Upg::Missile,           {Upg::Missile},           3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "2  1    Attack (Focus): Discard this card to perform this attack.  You may roll additional attack dice equal to your agility value, to a maximum of 3 additional dice." },
  { "Adv Homing Missile",           "Adv Homing",       "advhomingmissiles",          Upg::Missile,           {Upg::Missile},           3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "3  2    Attack (Target Lock): Discard this card to perform this attack.  If this attack hits, deal 1 faceup Damage card to the defender.  Then cancel all dice results." },
  { "XX-23 S-Thread Tracers",       "XX23 Tracers",     "xx23sthreadtracers",         Upg::Missile,           {Upg::Missile},           1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),         "3  1-2  Attack (Focus):  Discard this card to perform this attack.  If this attack hits, each friendly ship at Range 1-2 of you may acquire a target lock on the defender.  Then cancel all dice results." },

  { "Chewbacca",                    "Chewbacca",        "chewbacca",                  Upg::Crew,              {Upg::Crew},              4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When you are dealt a Damage card, you may immediately discard that card and recover 1 shield.  Then, discard this upgrade card." },
  { "Luke Skywalker",               "Luke Skywalker",   "lukeskywalker",              Upg::Crew,              {Upg::Crew},              7, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "After you perform an attack that does not hit, you may immediately perform a primary weapon attack.  You may change 1 {FOCUS} result to a {HIT} result.  You cannot perform another attack this round." },
  { "Nien Nunb",                    "Nien Nunb",        "niennunb",                   Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "You may treat all {STRAIGHT} maneuvers as green maneuvers." },
  { "Weapons Engineer",             "Weapons Eng",      "weaponsengineer",            Upg::Crew,              {Upg::Crew},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "You may maintain 2 target locks (only 1 per enemy ship).  When you acquire a target lock, you may lock onto 2 different ships." },
  { "Gunner",                       "Gunner",           "gunner",                     Upg::Crew,              {Upg::Crew},              5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After you perform an attack that does not hit, you may immediately perform a primary weapon attack.  You cannot perform another attack this round." },
  { "Mercenary Copilot",            "Merc Copilot",     "mercenarycopilot",           Upg::Crew,              {Upg::Crew},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking at Range 3, you may change 1 of your {HIT} results to a {CRIT} result." },
  { "Intelligence Agent",           "Intel Agent",      "intelligenceagent",          Upg::Crew,              {Upg::Crew},              1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the start of the Activation phase, choose 1 enemy ship at Range 1-2.  You may look at that ship's chosen maneuver." },
  { "Recon Specialist",             "Recon Spec",       "reconspecialist",            Upg::Crew,              {Upg::Crew},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you perform a focus action, assign 1 additional focus token to your ship." },
  { "Saboteur",                     "Saboteur",         "saboteur",                   Upg::Crew,              {Upg::Crew},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "ActionL Choose 1 enemy ship at Range 1 and roll 1 attack die.  On a {HIT} or {CRIT} result, choose 1 random facedown Damage card assigned to that ship, flip it faceup, and resolve it." },
  { "Darth Vader",                  "Vader",            "darthvader",                 Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "After you perform an attack against an enemy ship, you may suffer 2 damage to cause that ship to suffer 1 critical damage." },
  { "Flight Instructor",            "Flight Inst",      "flightinstructor",           Upg::Crew,              {Upg::Crew},              4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When defending, you may reroll 1 of your {FOCUS} results.  If the attacker's pilot skill value is \"2\" or lower, you may reroll 1 of your blank results instead." },
  { "Navigator",                    "Navigator",        "navigator",                  Upg::Crew,              {Upg::Crew},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal a maneuver, you may rotate your dial to another maneuver with the same bearing.  You cannot rotate to a red maneuver if you have an stress tokens." },
  { "Rebel Captive",                "Rebel Captive",    "rebelcaptive",               Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "Once per round, the first ship that declares you as the target of an attack immediately receives 1 stress token." },
  { "C-3PO",                        "C-3PO",            "c3po",                       Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Once per round, before you roll 1 or more defense dice, you may guess aloud a number of {EVADE} results.  If you roll that many {EVADE} results (before modifying dice), add 1 {EVADE} result." },
  { "Han Solo",                     "Han Solo",         "hansolo",                    Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When attacking, if you have a target lock on the defender, you may spend that target lock to change all of your {FOCUS} results to {HIT} results." },
  { "Leia Organa",                  "Leia Organa",      "leiaorgana",                 Upg::Crew,              {Upg::Crew},              4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "At the start of the Activation phase, you may discard this card to allow all friendly ships that reveal a red maneuver to treat that maneuver as a white maneuver until the end of the phase." },
  { "R2-D2",                        "R2-D2",            "r2d2-swx22",                 Upg::Crew,              {Upg::Crew},              4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "At the end of the End phase, if you have no shields, you may recover 1 shield and roll 1 attack die.  On a {HIT} result, randomly flip 1 of your facedown Damage cards faceup and resolve it." },
  { "Tactician",                    "Tactician",        "tactician",                  Upg::Crew,              {Upg::Crew},              2, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After you perform an attack against a ship inside your firing arc at Range 2, that ship receives 1 stress token." },
  { "Jan Ors",                      "Jan Ors",          "janors",                     Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Once per round, when a friendly ship at Range 1-3 performs a focus action or would be assigned a focus token, you may assign that ship an evade token instead." },
  { "Kyle Katarn",                  "Kyle Katarn",      "kylekatarn",                 Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "After you remove a stress token from our ship, you may assign a focus token to your ship." },
  { "\"Leebo\"",                    "Leebo",            "leebo",                      Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Action: Perform a free boost action.  Then receive 1 ion token." },
  { "Dash Rendar",                  "Dash",             "dashrendar",                 Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "You may perform attacks while overlapping an obstacle.  Your attacks cannot be obstructed." },
  { "Lando Calrissian",             "Lando",            "landocalrissian",            Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Action: Roll 2 defense dice.  For each {FOCUS} result, assign 1 focus token to your ship.  For each {EVADE} result, assign 1 evade token to your ship." },
  { "Fleet Officer",                "Fleet Officer",    "fleetofficer",               Upg::Crew,              {Upg::Crew},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "Action: Choose up to 2 friendly ships at Range 1-2 and assign 1 focus token to each of those ships.  Then receive 1 stress token." },
  { "Mara Jade",                    "Mara Jade",        "marajade",                   Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "At the end of the Combat phase, each enemy ship at Range 1 that does not have a stress token receives 1 stress token." },
  { "Moff Jerjerrod",               "Moff Jerjerrod",   "moffjerjerrod",              Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "When you are dealt a faceup Damage card, you may discard this Upgrade card or another {CREW} upgrade to flip that Damage card facedown (without resolving its effect)." },
  { "Ysanne Isard",                 "Ysanne Isard",     "ysanneisard",                Upg::Crew,              {Upg::Crew},              4, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "At the start of the Combat phase, if you have no shields and at least 1 Damage card assigned to your ship, you may perform a free evade action." },
  { "Greedo",                       "Greedo",           "greedo",                     Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "The first time you attack each round and the first time you defend each round, the first Damage card dealt is dealt faceup." },
  { "K4 Security Droid",            "K4",               "k4securitydroid",            Upg::Crew,              {Upg::Crew},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "After executing a green maneuver, you may acquire a target lock." },
  { "Outlaw Tech",                  "Outlaw Tech",      "outlawtech",                 Upg::Crew,              {Upg::Crew},              2, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "After you execute a red maneuver, you may assign 1 focus token to your ship." },
  { "Emperor Palpatine",            "Palp",             "emperorpalpatine",           Upg::Crew,              {Upg::Crew,Upg::Crew},    8, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "Once per round, you may change a friendly ship's die result to any other die result.  That die result cannot be modified again." },
  { "Bossk",                        "Bossk",            "bossk",                      Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "After you perform an attack that does not hit, if you are not stressed, you must receive 1 stress token.  Then assign 1 focus token to your ship and acquire a target lock on the defender." },
  { "Bombardier",                   "Bombardier",       "bombardier",                 Upg::Crew,              {Upg::Crew},              1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When dropping a bomb, you may use the [{straight} 2] template instead of the [{straight} 1] template." },
  { "Agent Kallus",                 "Agent Kallus",     "agentkallus",                Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "At the start of the first round, choose 1 enemy small or large ship.  When attacking or defending against that ship, you may change 1 of your {FOCUS} results to a {HIT} or {EVADE} result." },
  //{ "Rear Admiral Chiraneau",       "RADM Chiraneau",   "rearadmiralchiraneau",       Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "" },
  { "\"Chopper\"",                  "Chopper",          "chopper",                    Upg::Crew,              {Upg::Crew},              0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "You may perform actions even while you are stressed.  After you perform an action while you are stressed, suffer 1 damage." },
  { "\"Zeb\" Orrelios",             "Zeb",              "zeborrelios",                Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Enemy ships inside your firing arc that you are touching are not considered to be touching you when either you or they activate during that Combat phase." },
  { "Ezra Bridger",                 "Ezra",             "ezrabridger",                Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When attacking, if you are stressed, you may change 1 of your {FOCUS} results to a {CRIT} result." },
  { "Hera Syndulla",                "Hera",             "herasyndulla",               Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "You can reveal and execute red maneuvers even while you are stressed." },
  { "Kanan Jarrus",                 "Kanan",            "kananjarrus",                Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Once per round, after a friendly ship at Range 1-2 executes a while maneuver, you may remove 1 stress token from that ship." },
  { "Sabine Wren",                  "Sabine",           "sabinewren",                 Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uSABW, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "You upgrade bar gains the {BOMB} upgrade icon.  Once per round, before a friendly bomb token is removed, choose 1 enemy ship at range 1 of that token.  That ship suffers 1 damage." },
  { "4-LOM",                        "4-LOM",            "4lom",                       Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "When attacking, during the \"Modify Attack Dice\" step, you may receive 1 ion token to choose 1 of the defender's focus or evade tokens.  That token cannot be spent during this attack." },
  { "Zuckuss",                      "Zuckuss",          "zuckuss",                    Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "When attacking, you may receive any number of stress tokens to choose an equal number of defense dice.  The defender must reroll those dice." },
  { "Gonk",                         "Gonk",             "gonk",                       Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "Action: Place 1 shield token on this card.  Action: Remove 1 shield token from this card to recover 1 shield (up to your shield value)." },
  { "Boba Fett",                    "Boba Fett",        "bobafett",                   Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "After performing an attack, if the defender was dealt a faceup Damage card, you may discard this card to choose and discard 1 of the defender's Upgrade cards." },
  { "Dengar",                       "Dengar",           "dengar",                     Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "When attacking, you may reroll 1 attack die.  If the defender is a unique pilot, you may instead reroll up to 2 attack dice." },
  { "Systems Officer",              "Sys Officer",      "systemsofficer",             Upg::Crew,              {Upg::Crew},              2, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "After you execute a green maneuver, choose another friendly ship at Range 1.  That ship may acquire a target lock." },
  { "Tail Gunner",                  "Tail Gunner",      "tailgunner",                 Upg::Crew,              {Upg::Crew},              2, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attackng from your rear-facing auxiliary firing arc, reduce the defender's agility by 1 (to a minimum of \"0\")." },
  { "Latts Razzi",                  "Latts Razzi",      "lattsrazzi",                 Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "When defending, you may remove 1 stress token from the attacker to add 1 {EVADE} result to your roll." },
  { "Ketsu Onyo",                   "Ketsu Onyo",       "ketsuonyo",                  Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "At the start of the End phase, you may choose 1 enemy ship inside your firing arc at Range 1-2.  That ship does not remove its tractor beam tokens." },
  { "IG-88D",                       "IG-88D",           "ig88d",                      Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "You have the pilot ability of each friendly ship with the IG-2000 Upgrade card (in addition to your own pilot ability)." },
  { "Finn",                         "Finn",             "finn",                       Upg::Crew,              {Upg::Crew},              5, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When attack with a primary weapon or defending, if the enemy ship is inside your firing arc, you may add 1 blank result to your roll." },
  { "Rey",                          "Rey",              "rey",                        Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "At the start of the end phase, you may place 1 of your ship 's focus tokens on this card.  At the start of the Combat phase, you may assign 1 of those tokens to your ship." },
  { "Hotshot Copilot",              "Hotshot Copilot",  "hotshotcopilot",             Upg::Crew,              {Upg::Crew},              4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking with a primary weapon, the defender must spend 1 focus token if able.  When defending, the attacker must spend 1 focus token if able." },
  { "Jyn Erso",                     "Jyn Erso",         "jynerso",                    Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Chose 1 friendly ship at Range 1-2.  Assign 1 focus token to that ship for each enemy ship inside your firing arc at Range 1-3.  You cannot assign more that 3 tokens in this way." },
  { "Cassian Andor",                "Cassian Andor",    "cassianandor",               Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "At the end of the Planning phase, you may choose an enemy ship at Range 1-2.  Guess aloud that ship's bearing and speed, then look at its dial.  If you are correct, you may rotate your dial to another maneuver." },
  { "Baze Malbus",                  "Baze Malbus",      "bazemalbus",                 Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "After you perform an attack that does not hit, you may immediately perform a primary weaon attack against a different ship.  You cannot perform another attack this round." },
  { "Bistan",                       "Bistan",           "bistan",                     Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When attacking at range 1-2, you may change 1 of your {HIT} results to a {CRIT} result." },
  { "Bodhi Rook",                   "Bodhi Rook",       "bodhirook",                  Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "When you acquire a target lock, you can lock onto an enemy ship at Range 1-3 of any friendly ship." },
  { "Inspiring Recruit",            "Insp Recruit",     "inspiringrecruit",           Upg::Crew,              {Upg::Crew},              1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "Once per round, when a friendly ship at range 1-2 removes a stress token, it may remove 1 additional stress token." },
  { "Captain Rex",                  "Capt. Rex",        "captainrex",                 Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   RNone), "After you perform an attack that does not hit, you may assign 1 focus token to your ship." },
  { "Kylo Ren",                     "Kylo Ren",         "kyloren",                    Upg::Crew,              {Upg::Crew},              3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "Action: Assign the \"I'll Show You the Dark Side\" Condition card to an enemy ship at Range 1-3." },
  { "General Hux",                  "Gen. Hux",         "generalhux",                 Upg::Crew,              {Upg::Crew},              5, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Empire, BaseSize::All,   RNone), "Action: Choose up to 3 friendly ships at Range 1-2.  Assign 1 focus token to each of those ships and assign the \"Fanatical Devotion\" Condition card to 1 of them.  Then receive 1 stress token." },
  { "Operations Specialist",        "Ops Specialist",   "operationsspecialist",       Upg::Crew,              {Upg::Crew},              3, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After a friendly ship at Range 1-2 performs an attack that does not hit, you may assign 1 focus token to a friendly ship at Range 1-3 of the attacker." },
  { "Unkar Plutt",                  "Unkay Plutt",      "unkarplutt",                 Upg::Crew,              {Upg::Crew},              1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Scum,   BaseSize::All,   RNone), "After executing a maneuver that causes you to overlap an enemy ship, you may suffer 1 damage to perform 1 free action." },
  { "BoShek",                       "BoShek",           "boshek",                     Upg::Crew,              {Upg::Crew},              2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When a ship you are touching activates, you may look at its chosen maneuver.  IF you do, its owner must rotate the dial to an adjacent maneuver.  The ship can reveal and execute that maneuver even while stressed." },

  { "Millennium Falcon",            "MF",               "millenniumfalcon",           Upg::Title,             {Upg::Title},             1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, aMFAL, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("yt1300")),                  "Your action bar gains the {EVADE} icon." },
  { "Slave 1",                      "Slave 1",          "slave1",                     Upg::Title,             {Upg::Title},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("firespray31")),             "Your upgrade bar gains the {TORPEDO} icon." },
  { "Moldy Crow",                   "Moldy Crow",       "moldycrow",                  Upg::Title,             {Upg::Title},             3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("hwk290")),                  "During the End phase, do not remove unused focus tokens from your ship." },
  { "ST-321",                       "ST-321",           "st321",                      Upg::Title,             {Upg::Title},             3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("lambdaclassshuttle")),      "When acquiring a target lock, you may lock onto any enemy ship in the play area." },
  { "Royal Guard TIE",              "Royal Guard",      "royalguardtie",              Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uRGTI, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tieinterceptor")),          "You may equip up to 2 different Modification upgrades (instead of 1).  You cannot equip this card if your pilot skill value is \"4\" or lower." },
  { "A-Wing Test Pilot",            "Test Pilot",       "awingtestpilot",             Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uAWTP, UNone }, RC(Faction::All,    BaseSize::All,   Ship("awing")),                   "Your upgrade bar gains 1 {ELITE} upgrade icon.  You cannot equip 2 of the same {ELITE} Upgrade cards.  You cannot equip this card if your pilot skill value is \"1\" or lower" },
  { "Outrider",                     "Outrider",         "outrider",                   Upg::Title,             {Upg::Title},             5, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("yt2400")),                  "While you have a {CANNON} Upgrade card equipped, you cannot perform primary weapon attacks and you may perform {CANNON} secondary weapon attacks against ships outside your firing arc." },
  { "Dauntless",                    "Dauntless",        "dauntless",                  Upg::Title,             {Upg::Title},             2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("vt49")),                    "After you execute a maneuver that causes you to overlap another ship, you may perform 1 free action.  Then receive 1 stress token." },
  { "BTL-A4 Y-Wing",                "BTL-A4",           "btla4ywing",                 Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("ywing")),                   "You cannot attack ships outside your firing arc.  After you perform a primary weapon attack, you may immediately perform an attack with a {TURRET} secondary weapon." },
  { "Andrasta",                     "Andrasta",         "andrasta",                   Upg::Title,             {Upg::Title},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uANDR, UNone }, RC(Faction::All,    BaseSize::All,   Ship("firespray31")),             "Your upgrade bar gains two additional {BOMB} upgrade icons." },
  { "\"Heavy Scyk\" Interceptor",   "Heavy Scyk",       "heavyscykinterceptor",       Upg::Title,             {Upg::Title},             2, false, false, { SNone, SNone, SNone,  S(1), SNone, SNone, ANone, ANone, uHSCY, UNone }, RC(Faction::All,    BaseSize::All,   HSCY()),                          "Your upgrade bar gains the {CANNON}, {TORPEDO}, or {MISSILE} upgrade icon.  Increase your hull value by 1." },
  { "Virago",                       "Virago",           "virago",                     Upg::Title,             {Upg::Title},             1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uVIRA, UNone }, RC(Faction::All,    BaseSize::All,   Ship("starviper")),               "Your upgrade bar gains the {SYSTEM} and {ILLICIT} upgrade icons.  You cannot equip this card if your pilot skill value is \"3\" or lower." },
  { "IG-2000",                      "IG-2000",          "ig2000",                     Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("aggressor")),               "You have the pilot ability of each other friendly ship with the IG-2000 Upgrade card (in addition to your own pilot ability)." },
  { "TIE/x1",                       "TIE/x1",           "tiex1",                      Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, cTIX1, ANone, ANone, uTIX1, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tieadvanced")),             "Your upgrade bar gains the {SYSTEM} upgrade icon.  If you equip a {SYSTEM} upgrade, its squad point cost is reduced by 4 (to a minimum or 0)." },
  { "Hound's Tooth",                "Hounds Tooth",     "houndstooth",                Upg::Title,             {Upg::Title},             6, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("yv666")),                   "After you are destroyed, before you are removed from the play area, you may deploy the Nashtah Pup Pilot.  It cannon attack this round." },
  { "Ghost",                        "Ghost",            "ghost",                      Upg::Title,             {Upg::Title},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("vcx100")),                  "Equip the Phantom title card to a friendly Attack Shuttle and dock it to this ship.  After you execute a maneuver, you may deploy it from your rear guides." },
  { "Phantom",                      "Phantom",          "phantom",                    Upg::Title,             {Upg::Title},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "While you are docked, the Ghost can perform primary weapon attacks from its secial firing arc and, at the end of the Combat phase, it may perform an additional attack with an equipped {TURRET}.  If it performs this attack, it cannot attack again this round." },
  { "TIE/v1",                       "TIE/v1",           "tiev1",                      Upg::Title,             {Upg::Title},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tieadvancedprototype")),    "After you acquire a target lock, you may perform a free evade action." },
  { "Mist Hunter",                  "Mist Hunter",      "misthunter",                 Upg::Title,             {Upg::Title},             0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, aMHUN, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("g1astarfighter")),          "Your action bar gains the {BARRELROLL} action icon.  You must equip 1 \"Tractor Beam\" Upgrade card (paying its squad point cost as normal)." },
  { "Punishing One",                "Punishing One",    "punishingone",               Upg::Title,             {Upg::Title},            12, true,  false, { SNone,  S(1), SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("jumpmaster5000")),          "Increase your primary weapon value by 1." },
  { "TIE/x7",                       "TIE/x7",           "tiex7",                      Upg::Title,             {Upg::Title},            -2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, uTIX7 }, RC(Faction::All,    BaseSize::All,   Ship("tiedefender")),             "Your upgrade bar loses the {CANNON} and {MISSILE} upgrade icons.  After executing a 3-, 4-, or 5-speed maneuver, you may assign 1 evade token to your ship." },
  { "TIE/D",                        "TIE/D",            "tied",                       Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tiedefender")),             "Once per round, after you perform an attack with a {CANNON} secondary weapon that costs 3 or fewer squad points, you may perform a primary weapon attack." },
  { "TIE Shuttle",                  "TIE Shuttle",      "tieshuttle",                 Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uaTIS, urTIS }, RC(Faction::All,    BaseSize::All,   Ship("tiebomber")),               "Your upgrade bar loses all {TORPEDO}, {MISSIL}, and {BOMB} upgrade icons and gains 2 {CREW} upgrade icons.  You cannot equip a {CREW} Upgrade card that costs more than 4 squad points." },
  { "Alliance Overhaul",            "Alli Overhaul",    "allianceoverhaul",           Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("arc170")),                  "When attacking with a primary weapon from your primary firing arc, you may roll 1 additional attack die.  When attacking from your auxiliary firing arc, you may change 1 of your {FOCUS} results to a {CRIT} result." },
  { "Special Ops Training",         "SpecOps Train",    "specialopstraining",         Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tiesf")),                   "When attacking with a primary weapon from your primary firing arc, you may roll 1 additional attack die.  If you do not, you may perform an additional attack from your auxiliary firing arc." },
  { "Concord Dawn Protector",       "CD Protector",     "concorddawnprotector",       Upg::Title,             {Upg::Title},             1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("protectoratestarfighter")), "When defending, if you are inside the attacker's firing arc and at Range 1 and the attacker is inside your firing arc, add 1 {EVADE} result." },
  { "Shadow Caster",                "Shadow Caster",    "shadowcaster",               Upg::Title,             {Upg::Title},             3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("lancerclasspursuitcraft")), "After you perform an attack that hits, if the defender is inside your mobile firing arc and at Range 1-2, you may assign the defender 1 tractor beam token." },
  { "Black One",                    "Black One",        "blackone",                   Upg::Title,             {Upg::Title},             1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("t70xwing")),                "After you perform a boost or barrel roll action, you may remove 1 enemy target lock from a friendly ship at Range 1.  You cannot equip this card if your pilot skill is \"6\" or lower." },
  { "Millennium Falcon",            "MF (HOTR)",        "millenniumfalcon-swx57",     Upg::Title,             {Upg::Title},             1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("yt1300")),                  "After you execute a 3-speed bank maneuver [{LBANK} or {RBANK}], if you are not touching another ship and you are not stressed, you may receive 1 stress token to rotate your ship 180˚." },
  { "Pivot Wing",                   "Pivot Wing",       "pivotwing",                  Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("uwing")),                   "Increase your agility value by 1.  After you execute a maneuver, you may flip this card. - When you reveal a [0 {STATIONARY}] maneuver, you may rotate your ship 180˚.  After you execute a maneuver, you may flip this card." },
  { "Adaptive Ailerons",            "Adapt Ailerons",   "adaptiveailerons",           Upg::Title,             {Upg::Title},             0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tiestriker")),              "Immediately before you reveal your dial, if you are not stressed, you must execute a white [{LBANK} 1], [{STRAIGHT} 1], or [{RBANK} 1} maneuver." },
  { "Sabine's Masterpiece",         "Sabine's Mpiece",  "sabinesmasterpiece",         Upg::Title,             {Upg::Title},             1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uSAMP, UNone }, RC(Faction::Rebel,  BaseSize::All,   Ship("tiefighter")),              "Your upgrade bar gains that {CREW} and {ILLICIT} upgrade icons." },
  { "Kylo Ren's Shuttle",           "Kylo Ren's",       "kylorensshuttle",            Upg::Title,             {Upg::Title},             2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uSAMP, UNone }, RC(Faction::All,    BaseSize::All,   Ship("upsilonclassshuttle")),     "At the end of the Combat phase, choose an unstressed enemy ship at Range 1-2.  Its owner must assign a stress token to it or assign a stress token to another ship at range 1-2 of you that that place player controls." },

  { "Engine Upgrade",               "EU",               "engineupgrade",              Upg::Modification,      {Upg::Modification},      4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, aENUP, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Your action bar gains the {BOOST} icon." },
  { "Shield Upgrade",               "SU",               "shieldupgrade",              Upg::Modification,      {Upg::Modification},      4, false, false, { SNone, SNone, SNone, SNone,  S(1), SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Increase your shield value by 1." },
  { "Stealth Device",               "Stealth Dev",      "stealthdevice",              Upg::Modification,      {Upg::Modification},      3, false, false, { SNone, SNone,  S(1), SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Increase your agility value by 1.  If you are hit by an attack, discard this card." },
  { "Anti-Pursuit Lasers",          "AntiPursuit L",    "antipursuitlasers",          Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone),                           "After an enemy ship executes a maneuver that causes it to overlap your ship, roll 1 attack die.  On a {HIT} or {CRIT} result, the enemy ship suffers 1 damage." },
  { "Hull Upgrade",                 "HU",               "hullupgrade",                Upg::Modification,      {Upg::Modification},      3, false, false, { SNone, SNone, SNone,  S(1), SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Increase your hull value by 1." },
  { "Targeting Computer",           "Targeting Comp",   "targetingcomputer",          Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, aTCOM, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Your action bar gains the {TARGETLOCK} action icon." },
  { "B-Wing/E2",                    "E2",               "bwinge2",                    Upg::Modification,      {Upg::Modification},      1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uBWE2, UNone }, RC(Faction::All,    BaseSize::All,   Ship("bwing")),                   "Your upgrade bar gains the {CREW} upgrade icon." },
  { "Munitions Failsafe",           "Muni Failsafe",    "munitionsfailsafe",          Upg::Modification,      {Upg::Modification},      1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "When attacking with a secondary weapon that instructs you to discard it to perform the attack, do not discard it unless the attack hits." },
  { "Advanced Cloaking Device",     "Adv Cloak Dev",    "advancedcloakingdevice",     Upg::Modification,      {Upg::Modification},      4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tiephantom")),              "After you perform an attack, you may perform a free cloak action." },
  { "Stygium Particle Accelerator", "Styg Part Accl",   "stygiumparticleaccelerator", Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "When you either decloak or perform a cloak action, you may perform a free evade action." },
  { "Countermeasures",              "Countermeas",      "countermeasures",            Upg::Modification,      {Upg::Modification},      3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone),                           "At the start of the Combat phase, you may discard this card to increase your agility value by1 until the end of the round.  Then you may remove 1 enemy target lock from your ship." },
  { "Experimental Interface",       "EI",               "experimentalinterface",      Upg::Modification,      {Upg::Modification},      3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Once per round, after you perform an action, you may perform 1 free action from an equipped Upgrade card with the Action: header.  Then receive 1 stress token." },
  { "Tactical Jammer",              "Tact Jammer",      "tacticaljammer",             Upg::Modification,      {Upg::Modification},      1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone),                           "Your ship can obstruct enemy attacks." },
  { "Autothrusters",                "Autothrusters",    "autothrusters",              Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   AT()),                            "When defending, if you are inside the attacker's firing arc beyond range 3 or outside the attacker's firing arc, you may change 1 of your blank results to a {EVADE} result.  You can equip this card only if you have the {BOOST} action icon." },
  { "Ion Projector",                "Ion Projector",    "ionprojector",               Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone),                           "After an enemy ship executes a maneuver that causes it to overlap your ship, roll 1 attack die.  On a {HIT} or {CRIT} result, the enemy ship receives 1 ion token." },
  { "Maneuvering Fins",             "Maneuv Fins",      "maneuveringfins",            Upg::Modification,      {Upg::Modification},      1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("yv666")),                   "When you reveal a turn maneuver ({LTURN} or {RTURN}), you may rotate your dial to the corresponding bank maneuver ({LBANK} or {RBANK}) of the same speed." },
  { "Advanced SLAM",                "Adv SLAM",         "advancedslam",               Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "After performing a SLAM action, if you did not overlap an obstacle or another ship, you may perform a free action." },
  { "Twin Ion Engine Mk. 2",        "TIE Mk 2",         "twinionenginemk2",           Upg::Modification,      {Upg::Modification},      1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   TIE()),                           "You may treat all bank maneuvers ({LBANK} or {RBANK}) as green maneuvers." },
  { "Integrated Astromech",         "Integrated Ast",   "integratedastromech",        Upg::Modification,      {Upg::Modification},      0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   XW()),                            "When you are dealt a Damage card, you may discard 1 of yoru {ASTROMECH} Upgrade cards to discard that Damage card (without resolving its effect)." },
  { "Guidance Chips",               "Guidance Chips",   "guidancechips",              Upg::Modification,      {Upg::Modification},      0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "Once per round, when attacking with a {TORPEDO} or {MISSILE} secondary weapon, you may change 1 die result to a {HIT} result (or a {CRIT} result if your primary weapon value is \"3\" or higher)." },
  { "Long-Range Scanners",          "LR Scanners",      "longrangescanners",          Upg::Modification,      {Upg::Modification},      0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),                           "You can acquire target locks on ships at Range 3 and beyond.  You cannot acquire target locks on ships at Range 1-2.  You can equip this card only if you have {TORPEDO} and {MISSILE} in your upgrade bar." },
  { "Vectored Thrusters",           "Vectored Thr",     "vectoredthrusters",          Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, aVECT, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone),                           "Your action bar gains the {BARRELROLL} action icon." },
  { "Gyroscopic Targeting",         "Gyro Targeting",   "gyroscopictargeting",        Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("lancerclasspursuitcraft")), "At the end of the combat phase, if you executed a 3-, 4-, or 5-speed maneuver this round, you may rotate your mobile firing arc." },
  { "Smuggling Compartment",        "Smuggling Comp",   "smugglingcompartment",       Upg::Modification,      {Upg::Modification},      0, false, true,  { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, uSCOM, UNone }, RC(Faction::All,    BaseSize::All,   YT()),                            "Your upgrade bar gains the {ILLICIT} upgrade icon.  You may equip 1 additional Modification upgrade that costs 3 or fewer squad points." },
  { "Lightweight Frame",            "LW Frame",         "lightweightframe",           Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   TIE()),                           "When defending, after rolling defense dice, if there are more attack dice than defense dice, roll 1 additional defense die.  You cannot equip this card if your agility value is \"3\" or higher." },
  { "Captured TIE",                 "Captured TIE",     "capturedtie",                Upg::Modification,      {Upg::Modification},      1, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::Rebel,  BaseSize::All,   Ship("tiefighter")),              "Enemy ships with a pilot skill value lower than yours cannot declare you as the target of an attack.  After you perform an attack or when you are the only remaining friendly ship in play, discard this card." },
  { "Spacetug Tractor Array",       "ST Tractor Ar",    "spacetugtractorarray",       Upg::Modification,      {Upg::Modification},      2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("quadjumper")),              "Action: Choose a ship inside your firing arc at Range 1 and assign a tractor beam token to it.  If it is a friendly ship, resolve the effect of the tractor beam token as though it were an enemy ship." },

  { "Heavy Laser Cannon",           "HLC",              "heavylasercannon",           Upg::Cannon,            {Upg::Cannon},            7, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "4  2-3  Attack: Attack 1 ship.  Immediately after rolling your attack dice, you must change all of your {CRIT} results to {HIT} results." },
  { "Ion Cannon",                   "Ion Cannon",       "ioncannon",                  Upg::Cannon,            {Upg::Cannon},            3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-3  Attack: Attack 1 ship.  If this attack hits, the defender suffers 1 damage and receives 1 ion token.  Then cancel all dice results." },
  { "Autoblaster",                  "Autobaster",       "autoblaster",                Upg::Cannon,            {Upg::Cannon},            5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1    Attack: Attack 1 ship.  Your {HIT} results cannot be canceled by defense dice.  The defender may cancel {CRIT} results before {HIT} results." },
  { "\"Mangler\" Cannon",           "Mangler",          "manglercannon",              Upg::Cannon,            {Upg::Cannon},            4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-3  Attack: Attack 1 ship.  When attacking, you may change 1 of your {HIT} results to a {CRIT} result." },
  { "Flechette Cannon",             "Flechette",        "flechettecannon",            Upg::Cannon,            {Upg::Cannon},            2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-3  Attack: Attack 1 ship.  If this attack hits, the defender suffers 1 damage and, if the defender is not stressed, its also receives 1 stress token.  Then cancel all dice results." },
  { "Tractor Beam",                 "Tractor Beam",     "tractorbeam",                Upg::Cannon,            {Upg::Cannon},            1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-3  Attack: Attack 1 ship.  If this attack hits, the defender receives 1 tractor beam token.  Then cancel all dice results." },

  { "Proximity Mines",              "Prox Mines",       "proximitymines",             Upg::Bomb,              {Upg::Bomb},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Discard this card to drop 1 proximity mine token.  When a ship's base or maneuver template overlaps this token, this token detonates." },
  { "Seismic Charges",              "Seismic Chrgs",    "seismiccharges",             Upg::Bomb,              {Upg::Bomb},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal your maneuver dial, you may discard this card to drop 1 seismic charge token.  This token detonates at the end of the Activation phase." },
  { "Proton Bombs",                 "Proton Bombs",     "protonbombs",                Upg::Bomb,              {Upg::Bomb},              5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal your maneuver dial, you may discard this card to drop 1 proton bomb token.  This token detonates at the end of the Activation phase." },
  { "Conner Net",                   "Conner Net",       "connernet",                  Upg::Bomb,              {Upg::Bomb},              4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Discard this card to drop 1 Conner net token.  When a ship's base or maneuver template overlaps this token, the token detonates." },
  { "Ion Bombs",                    "Ion Bombs",        "ionbombs",                   Upg::Bomb,              {Upg::Bomb},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal your maneuver dial, you may discard this card to drop 1 ion bomb token.  This token detonates at the end of the Activation phase." },
  { "Cluster Mines",                "Cluster Mines",    "clustermines",               Upg::Bomb,              {Upg::Bomb},              4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Discard this card to drop 1 cluster mine token set.  When a ship's base or maneuver template overlaps a cluster mine token, that token detonates." },
  { "Thermal Detonators",           "Therm Det",        "thermaldetonators",          Upg::Bomb,              {Upg::Bomb},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you reveal your maneuver dial, you may discard this card to drop 1 thermal detonator token.  This token detonates at the end of the Activation phase." },

  { "Advanced Sensors",             "Adv Sensors",      "advancedsensors",            Upg::System,            {Upg::System},            3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "Immediately before you reveal your maneuver, you may perform 1 free action.  If you use this ability, you must skip your \"Perform Action\" step during this round." },
  { "Sensor Jammer",                "Sensor Jammer",    "sensorjammer",               Upg::System,            {Upg::System},            4, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "When defending, you may change 1 of the attacker's {HIT} results to a {FOCUS} result.  The attacker cannot reroll the die with the changed result." },
  { "Fire-Control System",          "FCS",              "firecontrolsystem",          Upg::System,            {Upg::System},            2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "After you perform an attack, you may acquire a target lock on the defender." },
  { "Enhanced Scopes",              "Enh Scopes",       "enhancedscopes",             Upg::System,            {Upg::System},            1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "During the Activation phase, treat your pilot skill value as \"0\"." },
  { "Accuracy Corrector",           "Acc Correct",      "accuracycorrector",          Upg::System,            {Upg::System},            3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "When attacking, during the \"Modify Attack Dice\" step, you may cancel all of your dice results.  Then, you may add 2 {HIT} results to your roll.  Your dice cannot be modified again during this attack." },
  { "Adv. Targeting Computer",      "ATC",              "advtargetingcomputer",       Upg::System,            {Upg::System},            5, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   Ship("tieadvanced")), "When attacking with your primary weapon, if you ahve a target lock on the defender, you may add 1 {CRIT} result to your roll.  If you do, you cannot spend target locks during this attack." },
  { "Reinforced Deflectors",        "Reinforced Def",   "reinforceddeflectors",       Upg::System,            {Upg::System},            3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone),               "After defending, if you suffered a combination of 3 or more damage and critical damage during the attack, recover 1 shield (up to your shield value)." },
  { "Electronic Baffle",            "Electronic Baf",   "electronicbaffle",           Upg::System,            {Upg::System},            1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "When you receive a stress token or an ion token, you may suffer 1 damage to discard that token." },
  { "Collision Detector",           "Collision Det",    "collisiondetector",          Upg::System,            {Upg::System},            0, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone),               "When performing a boost, barrel roll, or decloak, your ship and maneuver template can overlap obstacles.  When rolling for obstacle damage ignore all {CRIT} results." },

  { "\"Genius\"",                   "Genius",           "genius",                     Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 0, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "If you are equipped with a bomb that can be dropped when you reveal your maneuver, you may drop the bomb after you execute your maneuver instead." },
  { "R4 Agromech",                  "R4",               "r4agromech",                 Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, after you spend a focus token, you may acquire a target lock on the defender." },
  { "R4-B11",                       "R4-B11",           "r4b11",                      Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, if you have a target lock on the defender, you may spend the target lock to choose any or all defense dice.  The defender must reroll the chosen dice." },
  { "Salvaged Astromech",           "Salvaged",         "salvagedastromech",          Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you are dealt a faceup Damage card with the Ship trait, you may immediately discard that card (before resolving its effect).  Then, discard this Upgrade card." },
  { "Unhinged Astromech",           "Unhinged",         "unhingedastromech",          Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "You may treat all 3-speed maneuvers as green maneuvers." },
  { "R5-P8",                        "R5-P8",            "r5p8",                       Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 3, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Once per round, after defending, you may roll 1 attack die.  On a {HIT} result, the attacker suffers 1 damage.  On a {CRIT} result, you and the attacker each suffer 1 damage." },
  { "Overclocked R4",               "Overclkd R4",      "overclockedr4",              Upg::SalvagedAstromech, {Upg::SalvagedAstromech}, 1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "During the Combat phase, when you spend a focus token, you may receive 1 stress token to assign 1 focus token to your ship." },

  { "\"Hot Shot\" Blaster",         "Hot Shot",         "hotshotblaster",             Upg::Illicit,           {Upg::Illicit},           3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "3  1-2  Attack: Discard this card to attack 1 ship (even a ship outside your firing arc)." },
  { "Inertial Dampeners",           "Inertial Damp",    "inertialdampeners",          Upg::Illicit,           {Upg::Illicit},           1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you revel your maneuver, you may discard this card to instead perform a white [{STATIONARY} 0] maneuver.  Then receive 1 stress token." },
  { "Dead Man's Switch",            "Dead Mans Sw",     "deadmansswitch",             Upg::Illicit,           {Upg::Illicit},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When you are destroyed, each ship at range 1 suffers 1 damage." },
  { "Feedback Array",               "Feedback Ar",      "feedbackarray",              Upg::Illicit,           {Upg::Illicit},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "During the Combat phase, instead of performing any attacks, you may receive 1 ion token and suffer 1 damage to choose 1 enemy ship at Range 1.  That ship suffers 1 damage." },
  { "Glitterstim",                  "Glitterstim",      "glitterstim",                Upg::Illicit,           {Upg::Illicit},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "At the start of the Combat phase, you may discard this card and receive 1 stress token.  If you do, until the end of the round, when attacking or defending, you may change all of your {FOCUS} results to {HIT} or {EVADE} results." },
  { "Cloaking Device",              "Cloak Dev",        "cloakingdevice",             Upg::Illicit,           {Upg::Illicit},           2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "Action: Perform a free cloak action.  At the end of each round, if you are cloaked, roll 1 attack die.  On a {FOCUS} result, discard this card, then decloak or discard your cloak token." },
  { "Rigged Cargo Chute",           "Rigged Cargo",     "riggedcargochute",           Upg::Illicit,           {Upg::Illicit},           1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone), "Action: Discard this card to drop one cargo token." },
  { "Black Market Slicer Tools",    "BMST",             "blackmarketslicertools",     Upg::Illicit,           {Upg::Illicit},           1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "Action: Choose a stressed enemy ship at Range 1-2 and roll 1 attack die.  On a {HIT} or {CRIT} result, remove 1 stress token and deal it 1 facedown Damage card." },
  { "Burnout SLAM",                 "Burnout SLAM",     "burnoutslam",                Upg::Illicit,           {Upg::Illicit},           1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, aBOSL, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Large, RNone), "Your action bar gains the {SLAM} action icon.  After you perform a SLAM action, discard this card." },
  { "EMP Device",                   "EMP",              "empdevice",                  Upg::Illicit,           {Upg::Illicit},           2, true,  false, { SNone, SNone, SNone, SNone, SNone, SNone, aBOSL, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "During the Combat phase, instead of performing any attacks, you may discard this card to assign 2 ion tokens to each ship at Range 1." },
  { "Scavenger Crane",              "Scav Crane",       "scavengercrane",             Upg::Illicit,           {Upg::Illicit},           2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, aBOSL, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "After a ship at Range 1-2 is destroyed, you may choose a discarded {TORPEDO}, {MISSILE}, {BOMB}, {CANNON}, {TURRET}, or Modification Upgrade card that was equipped to your ship and flip it faceup.  Then roll 1 attack die.  On a blank result, discard Scavenger Crane." },

  { "Weapons Guidance",             "Weap Guidance",    "weaponsguidance",            Upg::Tech,              {Upg::Tech},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When attacking, you may spend a focus token to change 1 of your blank results to a {HIT} result." },
  { "Comm Relay",                   "Comm Relay",       "commrelay",                  Upg::Tech,              {Upg::Tech},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "You cannot have more than 1 evade token.  During the End phase, do not remove an unused evade token from your ship." },
  { "Sensor Cluster",               "Sensor Cluster",   "sensorcluster",              Upg::Tech,              {Upg::Tech},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When defending, you may spend a focus token to change 1 of your blank results to an {EVADE} result." },
  { "Pattern Analyzer",             "Pattern Analuzer", "patternanalyzer",            Upg::Tech,              {Upg::Tech},              2, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::All,   RNone), "When executing a maneuver, you may resolve the \"Check Pilot Stress\" step after the \"Perform Action\" step (instead of before that step)." },
  { "Primed Thrusters",             "Primed Thristers", "primedthrusters",            Upg::Tech,              {Upg::Tech},              1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "Stress tokens do not prevent you from performing boost or barrel roll actions unless you have 3 or more stress tokens." },
  { "Hyperwave Comm Scanner",       "Hyperwave CS",     "hyperwavecommscanner",       Upg::Tech,              {Upg::Tech},              1, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "At the start of the \"Place Forces\" step, you may shoose to treat your pilot skill value as \"0,\" \"6,\" or \"12\" until the end of the step.  During setup, after another friendly ship is placed at Range 1-2, you may assign 1 focus or evade token to it." },
  { "Targeting Synchronizer",       "Target Sync",      "targetingsynchronizer",      Upg::Tech,              {Upg::Tech},              3, false, false, { SNone, SNone, SNone, SNone, SNone, SNone, ANone, ANone, UNone, UNone }, RC(Faction::All,    BaseSize::Small, RNone), "When a friendly ship at Range 1-2 is attacking a ship you have locked, the friendly ship treats the \"Attack (Target Lock):\" header as \"Attack:.\"  If a game effect instructs that ship to spend a target lock, it may spend you target lock instead." },
};
